/*! For license information please see buttplug.min.js.LICENSE.txt */
!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["buttplug-commonjs"]=t():e.Buttplug=t()}(window,(function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,__webpack_require__),n.l=!0,n.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)__webpack_require__.d(r,n,function(t){return e[t]}.bind(null,n));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s="./src/index.ts")}({"./node_modules/base64-js/index.js":function(e,t,r){"use strict";t.byteLength=function byteLength(e){var t=getLens(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function toByteArray(e){var t,r,n=getLens(e),i=n[0],a=n[1],u=new s(function _byteLength(e,t,r){return 3*(t+r)/4-r}(0,i,a)),c=0,f=a>0?i-4:i;for(r=0;r<f;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;2===a&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,u[c++]=255&t);1===a&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t);return u},t.fromByteArray=function fromByteArray(e){for(var t,r=e.length,o=r%3,s=[],i=16383,a=0,u=r-o;a<u;a+=i)s.push(encodeChunk(e,a,a+i>u?u:a+i));1===o?(t=e[r-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return s.join("")};for(var n=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=i.length;a<u;++a)n[a]=i[a],o[i.charCodeAt(a)]=a;function getLens(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function encodeChunk(e,t,r){for(var o,s,i=[],a=t;a<r;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(n[(s=o)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return i.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},"./node_modules/class-transformer/esm5/ClassTransformer.js":function(e,t,r){"use strict";r.r(t),r.d(t,"ClassTransformer",(function(){return i}));var n=r("./node_modules/class-transformer/esm5/TransformOperationExecutor.js"),o=r("./node_modules/class-transformer/esm5/enums/index.js"),s=r("./node_modules/class-transformer/esm5/constants/default-options.constant.js"),__assign=function(){return __assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__assign.apply(this,arguments)},i=function(){function ClassTransformer(){}return ClassTransformer.prototype.instanceToPlain=function(e,t){return new n.TransformOperationExecutor(o.TransformationType.CLASS_TO_PLAIN,__assign(__assign({},s.defaultOptions),t)).transform(void 0,e,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.classToPlainFromExist=function(e,t,r){return new n.TransformOperationExecutor(o.TransformationType.CLASS_TO_PLAIN,__assign(__assign({},s.defaultOptions),r)).transform(t,e,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.plainToInstance=function(e,t,r){return new n.TransformOperationExecutor(o.TransformationType.PLAIN_TO_CLASS,__assign(__assign({},s.defaultOptions),r)).transform(void 0,t,e,void 0,void 0,void 0)},ClassTransformer.prototype.plainToClassFromExist=function(e,t,r){return new n.TransformOperationExecutor(o.TransformationType.PLAIN_TO_CLASS,__assign(__assign({},s.defaultOptions),r)).transform(e,t,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.instanceToInstance=function(e,t){return new n.TransformOperationExecutor(o.TransformationType.CLASS_TO_CLASS,__assign(__assign({},s.defaultOptions),t)).transform(void 0,e,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.classToClassFromExist=function(e,t,r){return new n.TransformOperationExecutor(o.TransformationType.CLASS_TO_CLASS,__assign(__assign({},s.defaultOptions),r)).transform(t,e,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.serialize=function(e,t){return JSON.stringify(this.instanceToPlain(e,t))},ClassTransformer.prototype.deserialize=function(e,t,r){var n=JSON.parse(t);return this.plainToInstance(e,n,r)},ClassTransformer.prototype.deserializeArray=function(e,t,r){var n=JSON.parse(t);return this.plainToInstance(e,n,r)},ClassTransformer}()},"./node_modules/class-transformer/esm5/MetadataStorage.js":function(e,t,r){"use strict";r.r(t),r.d(t,"MetadataStorage",(function(){return o}));var n=r("./node_modules/class-transformer/esm5/enums/index.js"),o=function(){function MetadataStorage(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}return MetadataStorage.prototype.addTypeMetadata=function(e){this._typeMetadatas.has(e.target)||this._typeMetadatas.set(e.target,new Map),this._typeMetadatas.get(e.target).set(e.propertyName,e)},MetadataStorage.prototype.addTransformMetadata=function(e){this._transformMetadatas.has(e.target)||this._transformMetadatas.set(e.target,new Map),this._transformMetadatas.get(e.target).has(e.propertyName)||this._transformMetadatas.get(e.target).set(e.propertyName,[]),this._transformMetadatas.get(e.target).get(e.propertyName).push(e)},MetadataStorage.prototype.addExposeMetadata=function(e){this._exposeMetadatas.has(e.target)||this._exposeMetadatas.set(e.target,new Map),this._exposeMetadatas.get(e.target).set(e.propertyName,e)},MetadataStorage.prototype.addExcludeMetadata=function(e){this._excludeMetadatas.has(e.target)||this._excludeMetadatas.set(e.target,new Map),this._excludeMetadatas.get(e.target).set(e.propertyName,e)},MetadataStorage.prototype.findTransformMetadatas=function(e,t,r){return this.findMetadatas(this._transformMetadatas,e,t).filter((function(e){return!e.options||(!0===e.options.toClassOnly&&!0===e.options.toPlainOnly||(!0===e.options.toClassOnly?r===n.TransformationType.CLASS_TO_CLASS||r===n.TransformationType.PLAIN_TO_CLASS:!0!==e.options.toPlainOnly||r===n.TransformationType.CLASS_TO_PLAIN))}))},MetadataStorage.prototype.findExcludeMetadata=function(e,t){return this.findMetadata(this._excludeMetadatas,e,t)},MetadataStorage.prototype.findExposeMetadata=function(e,t){return this.findMetadata(this._exposeMetadatas,e,t)},MetadataStorage.prototype.findExposeMetadataByCustomName=function(e,t){return this.getExposedMetadatas(e).find((function(e){return e.options&&e.options.name===t}))},MetadataStorage.prototype.findTypeMetadata=function(e,t){return this.findMetadata(this._typeMetadatas,e,t)},MetadataStorage.prototype.getStrategy=function(e){var t=this._excludeMetadatas.get(e),r=t&&t.get(void 0),n=this._exposeMetadatas.get(e),o=n&&n.get(void 0);return r&&o||!r&&!o?"none":r?"excludeAll":"exposeAll"},MetadataStorage.prototype.getExposedMetadatas=function(e){return this.getMetadata(this._exposeMetadatas,e)},MetadataStorage.prototype.getExcludedMetadatas=function(e){return this.getMetadata(this._excludeMetadatas,e)},MetadataStorage.prototype.getExposedProperties=function(e,t){return this.getExposedMetadatas(e).filter((function(e){return!e.options||(!0===e.options.toClassOnly&&!0===e.options.toPlainOnly||(!0===e.options.toClassOnly?t===n.TransformationType.CLASS_TO_CLASS||t===n.TransformationType.PLAIN_TO_CLASS:!0!==e.options.toPlainOnly||t===n.TransformationType.CLASS_TO_PLAIN))})).map((function(e){return e.propertyName}))},MetadataStorage.prototype.getExcludedProperties=function(e,t){return this.getExcludedMetadatas(e).filter((function(e){return!e.options||(!0===e.options.toClassOnly&&!0===e.options.toPlainOnly||(!0===e.options.toClassOnly?t===n.TransformationType.CLASS_TO_CLASS||t===n.TransformationType.PLAIN_TO_CLASS:!0!==e.options.toPlainOnly||t===n.TransformationType.CLASS_TO_PLAIN))})).map((function(e){return e.propertyName}))},MetadataStorage.prototype.clear=function(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()},MetadataStorage.prototype.getMetadata=function(e,t){var r,n=e.get(t);n&&(r=Array.from(n.values()).filter((function(e){return void 0!==e.propertyName})));for(var o=[],s=0,i=this.getAncestors(t);s<i.length;s++){var a=i[s],u=e.get(a);if(u){var c=Array.from(u.values()).filter((function(e){return void 0!==e.propertyName}));o.push.apply(o,c)}}return o.concat(r||[])},MetadataStorage.prototype.findMetadata=function(e,t,r){var n=e.get(t);if(n){var o=n.get(r);if(o)return o}for(var s=0,i=this.getAncestors(t);s<i.length;s++){var a=i[s],u=e.get(a);if(u){var c=u.get(r);if(c)return c}}},MetadataStorage.prototype.findMetadatas=function(e,t,r){var n,o=e.get(t);o&&(n=o.get(r));for(var s=[],i=0,a=this.getAncestors(t);i<a.length;i++){var u=a[i],c=e.get(u);c&&c.has(r)&&s.push.apply(s,c.get(r))}return s.slice().reverse().concat((n||[]).slice().reverse())},MetadataStorage.prototype.getAncestors=function(e){if(!e)return[];if(!this._ancestorsMap.has(e)){for(var t=[],r=Object.getPrototypeOf(e.prototype.constructor);void 0!==r.prototype;r=Object.getPrototypeOf(r.prototype.constructor))t.push(r);this._ancestorsMap.set(e,t)}return this._ancestorsMap.get(e)},MetadataStorage}()},"./node_modules/class-transformer/esm5/TransformOperationExecutor.js":function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"TransformOperationExecutor",(function(){return i}));var n=r("./node_modules/class-transformer/esm5/storage.js"),o=r("./node_modules/class-transformer/esm5/enums/index.js"),s=r("./node_modules/class-transformer/esm5/utils/index.js"),__spreadArray=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};var i=function(){function TransformOperationExecutor(e,t){this.transformationType=e,this.options=t,this.recursionStack=new Set}return TransformOperationExecutor.prototype.transform=function(t,r,i,a,u,c){var f=this;if(void 0===c&&(c=0),Array.isArray(r)||r instanceof Set){var l=a&&this.transformationType===o.TransformationType.PLAIN_TO_CLASS?function instantiateArrayType(e){var t=new e;return t instanceof Set||"push"in t?t:[]}(a):[];return r.forEach((function(e,r){var n=t?t[r]:void 0;if(f.options.enableCircularCheck&&f.isCircular(e))f.transformationType===o.TransformationType.CLASS_TO_CLASS&&(l instanceof Set?l.add(e):l.push(e));else{var s=void 0;if("function"!=typeof i&&i&&i.options&&i.options.discriminator&&i.options.discriminator.property&&i.options.discriminator.subTypes){if(f.transformationType===o.TransformationType.PLAIN_TO_CLASS){s=i.options.discriminator.subTypes.find((function(t){return t.name===e[i.options.discriminator.property]}));var a={newObject:l,object:e,property:void 0},u=i.typeFunction(a);s=void 0===s?u:s.value,i.options.keepDiscriminatorProperty||delete e[i.options.discriminator.property]}f.transformationType===o.TransformationType.CLASS_TO_CLASS&&(s=e.constructor),f.transformationType===o.TransformationType.CLASS_TO_PLAIN&&(e[i.options.discriminator.property]=i.options.discriminator.subTypes.find((function(t){return t.value===e.constructor})).name)}else s=i;var d=f.transform(n,e,s,void 0,e instanceof Map,c+1);l instanceof Set?l.add(d):l.push(d)}})),l}if(i!==String||u){if(i!==Number||u){if(i!==Boolean||u){if((i===Date||r instanceof Date)&&!u)return r instanceof Date?new Date(r.valueOf()):null==r?r:new Date(r);if(Object(s.getGlobal)().Buffer&&(i===e||r instanceof e)&&!u)return null==r?r:e.from(r);if(Object(s.isPromise)(r)&&!u)return new Promise((function(e,t){r.then((function(t){return e(f.transform(void 0,t,i,void 0,void 0,c+1))}),t)}));if(u||null===r||"object"!=typeof r||"function"!=typeof r.then){if("object"==typeof r&&null!==r){i||r.constructor===Object||(Array.isArray(r)||r.constructor!==Array)&&(i=r.constructor),!i&&t&&(i=t.constructor),this.options.enableCircularCheck&&this.recursionStack.add(r);var d=this.getKeys(i,r,u),p=t||{};t||this.transformationType!==o.TransformationType.PLAIN_TO_CLASS&&this.transformationType!==o.TransformationType.CLASS_TO_CLASS||(p=u?new Map:i?new i:{});for(var _loop_1=function(e){if("__proto__"===e||"constructor"===e)return"continue";var s=e,a=e,f=e;if(!h.options.ignoreDecorators&&i)if(h.transformationType===o.TransformationType.PLAIN_TO_CLASS)(l=n.defaultMetadataStorage.findExposeMetadataByCustomName(i,e))&&(f=l.propertyName,a=l.propertyName);else if(h.transformationType===o.TransformationType.CLASS_TO_PLAIN||h.transformationType===o.TransformationType.CLASS_TO_CLASS){var l;(l=n.defaultMetadataStorage.findExposeMetadata(i,e))&&l.options&&l.options.name&&(a=l.options.name)}var d=void 0;d=h.transformationType===o.TransformationType.PLAIN_TO_CLASS?r[s]:r instanceof Map?r.get(s):r[s]instanceof Function?r[s]():r[s];var g=void 0,m=d instanceof Map;if(i&&u)g=i;else if(i){var y=n.defaultMetadataStorage.findTypeMetadata(i,f);if(y){var v={newObject:p,object:r,property:f},_=y.typeFunction?y.typeFunction(v):y.reflectedType;y.options&&y.options.discriminator&&y.options.discriminator.property&&y.options.discriminator.subTypes?r[s]instanceof Array?g=y:(h.transformationType===o.TransformationType.PLAIN_TO_CLASS&&(g=void 0===(g=y.options.discriminator.subTypes.find((function(e){if(d&&d instanceof Object&&y.options.discriminator.property in d)return e.name===d[y.options.discriminator.property]})))?_:g.value,y.options.keepDiscriminatorProperty||d&&d instanceof Object&&y.options.discriminator.property in d&&delete d[y.options.discriminator.property]),h.transformationType===o.TransformationType.CLASS_TO_CLASS&&(g=d.constructor),h.transformationType===o.TransformationType.CLASS_TO_PLAIN&&d&&(d[y.options.discriminator.property]=y.options.discriminator.subTypes.find((function(e){return e.value===d.constructor})).name)):g=_,m=m||y.reflectedType===Map}else if(h.options.targetMaps)h.options.targetMaps.filter((function(e){return e.target===i&&!!e.properties[f]})).forEach((function(e){return g=e.properties[f]}));else if(h.options.enableImplicitConversion&&h.transformationType===o.TransformationType.PLAIN_TO_CLASS){var E=Reflect.getMetadata("design:type",i.prototype,f);E&&(g=E)}}var S=Array.isArray(r[s])?h.getReflectedType(i,f):void 0,w=t?t[s]:void 0;if(p.constructor.prototype){var b=Object.getOwnPropertyDescriptor(p.constructor.prototype,a);if((h.transformationType===o.TransformationType.PLAIN_TO_CLASS||h.transformationType===o.TransformationType.CLASS_TO_CLASS)&&(b&&!b.set||p[a]instanceof Function))return"continue"}if(h.options.enableCircularCheck&&h.isCircular(d)){if(h.transformationType===o.TransformationType.CLASS_TO_CLASS){M=d;(void 0!==(M=h.applyCustomTransformations(M,i,e,r,h.transformationType))||h.options.exposeUnsetFields)&&(p instanceof Map?p.set(a,M):p[a]=M)}}else{var T=h.transformationType===o.TransformationType.PLAIN_TO_CLASS?a:e,M=void 0;h.transformationType===o.TransformationType.CLASS_TO_PLAIN?(M=r[T],M=h.applyCustomTransformations(M,i,T,r,h.transformationType),M=r[T]===M?d:M,M=h.transform(w,M,g,S,m,c+1)):void 0===d&&h.options.exposeDefaultValues?M=p[a]:(M=h.transform(w,d,g,S,m,c+1),M=h.applyCustomTransformations(M,i,T,r,h.transformationType)),(void 0!==M||h.options.exposeUnsetFields)&&(p instanceof Map?p.set(a,M):p[a]=M)}},h=this,g=0,m=d;g<m.length;g++){_loop_1(m[g])}return this.options.enableCircularCheck&&this.recursionStack.delete(r),p}return r}return r}return null==r?r:Boolean(r)}return null==r?r:Number(r)}return null==r?r:String(r)},TransformOperationExecutor.prototype.applyCustomTransformations=function(e,t,r,o,s){var i=this,a=n.defaultMetadataStorage.findTransformMetadatas(t,r,this.transformationType);return void 0!==this.options.version&&(a=a.filter((function(e){return!e.options||i.checkVersion(e.options.since,e.options.until)}))),(a=this.options.groups&&this.options.groups.length?a.filter((function(e){return!e.options||i.checkGroups(e.options.groups)})):a.filter((function(e){return!e.options||!e.options.groups||!e.options.groups.length}))).forEach((function(t){e=t.transformFn({value:e,key:r,obj:o,type:s,options:i.options})})),e},TransformOperationExecutor.prototype.isCircular=function(e){return this.recursionStack.has(e)},TransformOperationExecutor.prototype.getReflectedType=function(e,t){if(e){var r=n.defaultMetadataStorage.findTypeMetadata(e,t);return r?r.reflectedType:void 0}},TransformOperationExecutor.prototype.getKeys=function(e,t,r){var s=this,i=n.defaultMetadataStorage.getStrategy(e);"none"===i&&(i=this.options.strategy||"exposeAll");var a=[];if(("exposeAll"===i||r)&&(a=t instanceof Map?Array.from(t.keys()):Object.keys(t)),r)return a;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&e){var u=n.defaultMetadataStorage.getExposedProperties(e,this.transformationType),c=n.defaultMetadataStorage.getExcludedProperties(e,this.transformationType);a=__spreadArray(__spreadArray([],u,!0),c,!0)}if(!this.options.ignoreDecorators&&e){u=n.defaultMetadataStorage.getExposedProperties(e,this.transformationType);this.transformationType===o.TransformationType.PLAIN_TO_CLASS&&(u=u.map((function(t){var r=n.defaultMetadataStorage.findExposeMetadata(e,t);return r&&r.options&&r.options.name?r.options.name:t}))),a=this.options.excludeExtraneousValues?u:a.concat(u);var f=n.defaultMetadataStorage.getExcludedProperties(e,this.transformationType);f.length>0&&(a=a.filter((function(e){return!f.includes(e)}))),void 0!==this.options.version&&(a=a.filter((function(t){var r=n.defaultMetadataStorage.findExposeMetadata(e,t);return!r||!r.options||s.checkVersion(r.options.since,r.options.until)}))),a=this.options.groups&&this.options.groups.length?a.filter((function(t){var r=n.defaultMetadataStorage.findExposeMetadata(e,t);return!r||!r.options||s.checkGroups(r.options.groups)})):a.filter((function(t){var r=n.defaultMetadataStorage.findExposeMetadata(e,t);return!(r&&r.options&&r.options.groups&&r.options.groups.length)}))}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(a=a.filter((function(e){return s.options.excludePrefixes.every((function(t){return e.substr(0,t.length)!==t}))}))),a=a.filter((function(e,t,r){return r.indexOf(e)===t}))},TransformOperationExecutor.prototype.checkVersion=function(e,t){var r=!0;return r&&e&&(r=this.options.version>=e),r&&t&&(r=this.options.version<t),r},TransformOperationExecutor.prototype.checkGroups=function(e){return!e||this.options.groups.some((function(t){return e.includes(t)}))},TransformOperationExecutor}()}.call(this,r("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/class-transformer/esm5/constants/default-options.constant.js":function(e,t,r){"use strict";r.r(t),r.d(t,"defaultOptions",(function(){return n}));var n={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0}},"./node_modules/class-transformer/esm5/decorators/exclude.decorator.js":function(e,t,r){"use strict";r.r(t),r.d(t,"Exclude",(function(){return Exclude}));var n=r("./node_modules/class-transformer/esm5/storage.js");function Exclude(e){return void 0===e&&(e={}),function(t,r){n.defaultMetadataStorage.addExcludeMetadata({target:t instanceof Function?t:t.constructor,propertyName:r,options:e})}}},"./node_modules/class-transformer/esm5/decorators/expose.decorator.js":function(e,t,r){"use strict";r.r(t),r.d(t,"Expose",(function(){return Expose}));var n=r("./node_modules/class-transformer/esm5/storage.js");function Expose(e){return void 0===e&&(e={}),function(t,r){n.defaultMetadataStorage.addExposeMetadata({target:t instanceof Function?t:t.constructor,propertyName:r,options:e})}}},"./node_modules/class-transformer/esm5/decorators/index.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/class-transformer/esm5/decorators/exclude.decorator.js");r.d(t,"Exclude",(function(){return n.Exclude}));var o=r("./node_modules/class-transformer/esm5/decorators/expose.decorator.js");r.d(t,"Expose",(function(){return o.Expose}));var s=r("./node_modules/class-transformer/esm5/decorators/transform-instance-to-instance.decorator.js");r.d(t,"TransformInstanceToInstance",(function(){return s.TransformInstanceToInstance}));var i=r("./node_modules/class-transformer/esm5/decorators/transform-instance-to-plain.decorator.js");r.d(t,"TransformInstanceToPlain",(function(){return i.TransformInstanceToPlain}));var a=r("./node_modules/class-transformer/esm5/decorators/transform-plain-to-instance.decorator.js");r.d(t,"TransformPlainToInstance",(function(){return a.TransformPlainToInstance}));var u=r("./node_modules/class-transformer/esm5/decorators/transform.decorator.js");r.d(t,"Transform",(function(){return u.Transform}));var c=r("./node_modules/class-transformer/esm5/decorators/type.decorator.js");r.d(t,"Type",(function(){return c.Type}))},"./node_modules/class-transformer/esm5/decorators/transform-instance-to-instance.decorator.js":function(e,t,r){"use strict";r.r(t),r.d(t,"TransformInstanceToInstance",(function(){return TransformInstanceToInstance}));var n=r("./node_modules/class-transformer/esm5/ClassTransformer.js");function TransformInstanceToInstance(e){return function(t,r,o){var s=new n.ClassTransformer,i=o.value;o.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=i.apply(this,t);return!!n&&("object"==typeof n||"function"==typeof n)&&"function"==typeof n.then?n.then((function(t){return s.instanceToInstance(t,e)})):s.instanceToInstance(n,e)}}}},"./node_modules/class-transformer/esm5/decorators/transform-instance-to-plain.decorator.js":function(e,t,r){"use strict";r.r(t),r.d(t,"TransformInstanceToPlain",(function(){return TransformInstanceToPlain}));var n=r("./node_modules/class-transformer/esm5/ClassTransformer.js");function TransformInstanceToPlain(e){return function(t,r,o){var s=new n.ClassTransformer,i=o.value;o.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=i.apply(this,t);return!!n&&("object"==typeof n||"function"==typeof n)&&"function"==typeof n.then?n.then((function(t){return s.instanceToPlain(t,e)})):s.instanceToPlain(n,e)}}}},"./node_modules/class-transformer/esm5/decorators/transform-plain-to-instance.decorator.js":function(e,t,r){"use strict";r.r(t),r.d(t,"TransformPlainToInstance",(function(){return TransformPlainToInstance}));var n=r("./node_modules/class-transformer/esm5/ClassTransformer.js");function TransformPlainToInstance(e,t){return function(r,o,s){var i=new n.ClassTransformer,a=s.value;s.value=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=a.apply(this,r);return!!o&&("object"==typeof o||"function"==typeof o)&&"function"==typeof o.then?o.then((function(r){return i.plainToInstance(e,r,t)})):i.plainToInstance(e,o,t)}}}},"./node_modules/class-transformer/esm5/decorators/transform.decorator.js":function(e,t,r){"use strict";r.r(t),r.d(t,"Transform",(function(){return Transform}));var n=r("./node_modules/class-transformer/esm5/storage.js");function Transform(e,t){return void 0===t&&(t={}),function(r,o){n.defaultMetadataStorage.addTransformMetadata({target:r.constructor,propertyName:o,transformFn:e,options:t})}}},"./node_modules/class-transformer/esm5/decorators/type.decorator.js":function(e,t,r){"use strict";r.r(t),r.d(t,"Type",(function(){return Type}));var n=r("./node_modules/class-transformer/esm5/storage.js");function Type(e,t){return void 0===t&&(t={}),function(r,o){var s=Reflect.getMetadata("design:type",r,o);n.defaultMetadataStorage.addTypeMetadata({target:r.constructor,propertyName:o,reflectedType:s,typeFunction:e,options:t})}}},"./node_modules/class-transformer/esm5/enums/index.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/class-transformer/esm5/enums/transformation-type.enum.js");r.d(t,"TransformationType",(function(){return n.TransformationType}))},"./node_modules/class-transformer/esm5/enums/transformation-type.enum.js":function(e,t,r){"use strict";var n;r.r(t),r.d(t,"TransformationType",(function(){return n})),function(e){e[e.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",e[e.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",e[e.CLASS_TO_CLASS=2]="CLASS_TO_CLASS"}(n||(n={}))},"./node_modules/class-transformer/esm5/index.js":function(e,t,r){"use strict";r.r(t),r.d(t,"classToPlain",(function(){return classToPlain})),r.d(t,"instanceToPlain",(function(){return instanceToPlain})),r.d(t,"classToPlainFromExist",(function(){return classToPlainFromExist})),r.d(t,"plainToClass",(function(){return plainToClass})),r.d(t,"plainToInstance",(function(){return plainToInstance})),r.d(t,"plainToClassFromExist",(function(){return plainToClassFromExist})),r.d(t,"instanceToInstance",(function(){return instanceToInstance})),r.d(t,"classToClassFromExist",(function(){return classToClassFromExist})),r.d(t,"serialize",(function(){return serialize})),r.d(t,"deserialize",(function(){return deserialize})),r.d(t,"deserializeArray",(function(){return deserializeArray}));var n=r("./node_modules/class-transformer/esm5/ClassTransformer.js");r.d(t,"ClassTransformer",(function(){return n.ClassTransformer}));var o=r("./node_modules/class-transformer/esm5/decorators/index.js");r.d(t,"Exclude",(function(){return o.Exclude})),r.d(t,"Expose",(function(){return o.Expose})),r.d(t,"TransformInstanceToInstance",(function(){return o.TransformInstanceToInstance})),r.d(t,"TransformInstanceToPlain",(function(){return o.TransformInstanceToPlain})),r.d(t,"TransformPlainToInstance",(function(){return o.TransformPlainToInstance})),r.d(t,"Transform",(function(){return o.Transform})),r.d(t,"Type",(function(){return o.Type}));r("./node_modules/class-transformer/esm5/interfaces/index.js");var s=r("./node_modules/class-transformer/esm5/enums/index.js");r.d(t,"TransformationType",(function(){return s.TransformationType}));var i=new n.ClassTransformer;function classToPlain(e,t){return i.instanceToPlain(e,t)}function instanceToPlain(e,t){return i.instanceToPlain(e,t)}function classToPlainFromExist(e,t,r){return i.classToPlainFromExist(e,t,r)}function plainToClass(e,t,r){return i.plainToInstance(e,t,r)}function plainToInstance(e,t,r){return i.plainToInstance(e,t,r)}function plainToClassFromExist(e,t,r){return i.plainToClassFromExist(e,t,r)}function instanceToInstance(e,t){return i.instanceToInstance(e,t)}function classToClassFromExist(e,t,r){return i.classToClassFromExist(e,t,r)}function serialize(e,t){return i.serialize(e,t)}function deserialize(e,t,r){return i.deserialize(e,t,r)}function deserializeArray(e,t,r){return i.deserializeArray(e,t,r)}},"./node_modules/class-transformer/esm5/interfaces/class-constructor.type.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/class-transformer-options.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/decorator-options/exclude-options.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/decorator-options/expose-options.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/decorator-options/transform-options.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/decorator-options/type-discriminator-descriptor.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/decorator-options/type-options.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/index.js":function(e,t,r){"use strict";r.r(t);r("./node_modules/class-transformer/esm5/interfaces/decorator-options/expose-options.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/decorator-options/exclude-options.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/decorator-options/transform-options.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/decorator-options/type-discriminator-descriptor.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/decorator-options/type-options.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/metadata/exclude-metadata.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/metadata/expose-metadata.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/metadata/transform-metadata.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/metadata/transform-fn-params.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/metadata/type-metadata.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/class-constructor.type.js"),r("./node_modules/class-transformer/esm5/interfaces/class-transformer-options.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/target-map.interface.js"),r("./node_modules/class-transformer/esm5/interfaces/type-help-options.interface.js")},"./node_modules/class-transformer/esm5/interfaces/metadata/exclude-metadata.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/metadata/expose-metadata.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/metadata/transform-fn-params.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/metadata/transform-metadata.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/metadata/type-metadata.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/target-map.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/interfaces/type-help-options.interface.js":function(e,t,r){"use strict";r.r(t)},"./node_modules/class-transformer/esm5/storage.js":function(e,t,r){"use strict";r.r(t),r.d(t,"defaultMetadataStorage",(function(){return n}));var n=new(r("./node_modules/class-transformer/esm5/MetadataStorage.js").MetadataStorage)},"./node_modules/class-transformer/esm5/utils/get-global.util.js":function(e,t,r){"use strict";r.r(t),function(e){function getGlobal(){return"undefined"!=typeof globalThis?globalThis:void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0}r.d(t,"getGlobal",(function(){return getGlobal}))}.call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/class-transformer/esm5/utils/index.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/class-transformer/esm5/utils/get-global.util.js");r.d(t,"getGlobal",(function(){return n.getGlobal}));var o=r("./node_modules/class-transformer/esm5/utils/is-promise.util.js");r.d(t,"isPromise",(function(){return o.isPromise}))},"./node_modules/class-transformer/esm5/utils/is-promise.util.js":function(e,t,r){"use strict";function isPromise(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}r.r(t),r.d(t,"isPromise",(function(){return isPromise}))},"./node_modules/eventemitter3/index.js":function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,o="~";function Events(){}function EE(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function addListener(e,t,r,n,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var i=new EE(r,n||e,s),a=o?o+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],i]:e._events[a].push(i):(e._events[a]=i,e._eventsCount++),e}function clearEvent(e,t){0==--e._eventsCount?e._events=new Events:delete e._events[t]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(o=!1)),EventEmitter.prototype.eventNames=function eventNames(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},EventEmitter.prototype.listeners=function listeners(e){var t=o?o+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,i=new Array(s);n<s;n++)i[n]=r[n].fn;return i},EventEmitter.prototype.listenerCount=function listenerCount(e){var t=o?o+e:e,r=this._events[t];return r?r.fn?1:r.length:0},EventEmitter.prototype.emit=function emit(e,t,r,n,s,i){var a=o?o+e:e;if(!this._events[a])return!1;var u,c,f=this._events[a],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,r),!0;case 4:return f.fn.call(f.context,t,r,n),!0;case 5:return f.fn.call(f.context,t,r,n,s),!0;case 6:return f.fn.call(f.context,t,r,n,s,i),!0}for(c=1,u=new Array(l-1);c<l;c++)u[c-1]=arguments[c];f.fn.apply(f.context,u)}else{var d,p=f.length;for(c=0;c<p;c++)switch(f[c].once&&this.removeListener(e,f[c].fn,void 0,!0),l){case 1:f[c].fn.call(f[c].context);break;case 2:f[c].fn.call(f[c].context,t);break;case 3:f[c].fn.call(f[c].context,t,r);break;case 4:f[c].fn.call(f[c].context,t,r,n);break;default:if(!u)for(d=1,u=new Array(l-1);d<l;d++)u[d-1]=arguments[d];f[c].fn.apply(f[c].context,u)}}return!0},EventEmitter.prototype.on=function on(e,t,r){return addListener(this,e,t,r,!1)},EventEmitter.prototype.once=function once(e,t,r){return addListener(this,e,t,r,!0)},EventEmitter.prototype.removeListener=function removeListener(e,t,r,n){var s=o?o+e:e;if(!this._events[s])return this;if(!t)return clearEvent(this,s),this;var i=this._events[s];if(i.fn)i.fn!==t||n&&!i.once||r&&i.context!==r||clearEvent(this,s);else{for(var a=0,u=[],c=i.length;a<c;a++)(i[a].fn!==t||n&&!i[a].once||r&&i[a].context!==r)&&u.push(i[a]);u.length?this._events[s]=1===u.length?u[0]:u:clearEvent(this,s)}return this},EventEmitter.prototype.removeAllListeners=function removeAllListeners(e){var t;return e?(t=o?o+e:e,this._events[t]&&clearEvent(this,t)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=o,EventEmitter.EventEmitter=EventEmitter,e.exports=EventEmitter},"./node_modules/ieee754/index.js":function(e,t){t.read=function(e,t,r,n,o){var s,i,a=8*o-n-1,u=(1<<a)-1,c=u>>1,f=-7,l=r?o-1:0,d=r?-1:1,p=e[t+l];for(l+=d,s=p&(1<<-f)-1,p>>=-f,f+=a;f>0;s=256*s+e[t+l],l+=d,f-=8);for(i=s&(1<<-f)-1,s>>=-f,f+=n;f>0;i=256*i+e[t+l],l+=d,f-=8);if(0===s)s=1-c;else{if(s===u)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,n),s-=c}return(p?-1:1)*i*Math.pow(2,s-n)},t.write=function(e,t,r,n,o,s){var i,a,u,c=8*s-o-1,f=(1<<c)-1,l=f>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,h=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,i=f):(i=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-i))<1&&(i--,u*=2),(t+=i+l>=1?d/u:d*Math.pow(2,1-l))*u>=2&&(i++,u/=2),i+l>=f?(a=0,i=f):i+l>=1?(a=(t*u-1)*Math.pow(2,o),i+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,o),i=0));o>=8;e[r+p]=255&a,p+=h,a/=256,o-=8);for(i=i<<o|a,c+=o;c>0;e[r+p]=255&i,p+=h,i/=256,c-=8);e[r+p-h]|=128*g}},"./node_modules/isarray/index.js":function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},"./node_modules/node-libs-browser/node_modules/buffer/index.js":function(e,t,r){"use strict";(function(e){var n=r("./node_modules/base64-js/index.js"),o=r("./node_modules/ieee754/index.js"),s=r("./node_modules/isarray/index.js");function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(e,t){if(kMaxLength()<t)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Buffer.prototype:(null===e&&(e=new Buffer(t)),e.length=t),e}function Buffer(e,t,r){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,e)}return from(this,e,t,r)}function from(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function fromArrayBuffer(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);Buffer.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Buffer.prototype:e=fromArrayLike(e,t);return e}(e,t,r,n):"string"==typeof t?function fromString(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!Buffer.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|byteLength(t,r);e=createBuffer(e,n);var o=e.write(t,r);o!==n&&(e=e.slice(0,o));return e}(e,t,r):function fromObject(e,t){if(Buffer.isBuffer(t)){var r=0|checked(t.length);return 0===(e=createBuffer(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function isnan(e){return e!=e}(t.length)?createBuffer(e,0):fromArrayLike(e,t);if("Buffer"===t.type&&s(t.data))return fromArrayLike(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function allocUnsafe(e,t){if(assertSize(t),e=createBuffer(e,t<0?0:0|checked(t)),!Buffer.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function fromArrayLike(e,t){var r=t.length<0?0:0|checked(t.length);e=createBuffer(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function checked(e){if(e>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|e}function byteLength(e,t){if(Buffer.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(e).length;default:if(n)return utf8ToBytes(e).length;t=(""+t).toLowerCase(),n=!0}}function slowToString(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,r);case"utf8":case"utf-8":return utf8Slice(this,t,r);case"ascii":return asciiSlice(this,t,r);case"latin1":case"binary":return latin1Slice(this,t,r);case"base64":return base64Slice(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function swap(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function bidirectionalIndexOf(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=Buffer.from(t,n)),Buffer.isBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,r,n,o);if("number"==typeof t)return t&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):arrayIndexOf(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,r,n,o){var s,i=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;i=2,a/=2,u/=2,r/=2}function read(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(o){var c=-1;for(s=r;s<a;s++)if(read(e,s)===read(t,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===u)return c*i}else-1!==c&&(s-=s-c),c=-1}else for(r+u>a&&(r=a-u),s=r;s>=0;s--){for(var f=!0,l=0;l<u;l++)if(read(e,s+l)!==read(t,l)){f=!1;break}if(f)return s}return-1}function hexWrite(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var i=0;i<n;++i){var a=parseInt(t.substr(2*i,2),16);if(isNaN(a))return i;e[r+i]=a}return i}function utf8Write(e,t,r,n){return blitBuffer(utf8ToBytes(t,e.length-r),e,r,n)}function asciiWrite(e,t,r,n){return blitBuffer(function asciiToBytes(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function latin1Write(e,t,r,n){return asciiWrite(e,t,r,n)}function base64Write(e,t,r,n){return blitBuffer(base64ToBytes(t),e,r,n)}function ucs2Write(e,t,r,n){return blitBuffer(function utf16leToBytes(e,t){for(var r,n,o,s=[],i=0;i<e.length&&!((t-=2)<0);++i)n=(r=e.charCodeAt(i))>>8,o=r%256,s.push(o),s.push(n);return s}(t,e.length-r),e,r,n)}function base64Slice(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function utf8Slice(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var s,a,u,c,f=e[o],l=null,d=f>239?4:f>223?3:f>191?2:1;if(o+d<=r)switch(d){case 1:f<128&&(l=f);break;case 2:128==(192&(s=e[o+1]))&&(c=(31&f)<<6|63&s)>127&&(l=c);break;case 3:s=e[o+1],a=e[o+2],128==(192&s)&&128==(192&a)&&(c=(15&f)<<12|(63&s)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:s=e[o+1],a=e[o+2],u=e[o+3],128==(192&s)&&128==(192&a)&&128==(192&u)&&(c=(15&f)<<18|(63&s)<<12|(63&a)<<6|63&u)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),o+=d}return function decodeCodePointsArray(e){var t=e.length;if(t<=i)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=i));return r}(n)}t.Buffer=Buffer,t.SlowBuffer=function SlowBuffer(e){+e!=e&&(e=0);return Buffer.alloc(+e)},t.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function typedArraySupport(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(e){return e.__proto__=Buffer.prototype,e},Buffer.from=function(e,t,r){return from(null,e,t,r)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(e,t,r){return function alloc(e,t,r,n){return assertSize(t),t<=0?createBuffer(e,t):void 0!==r?"string"==typeof n?createBuffer(e,t).fill(r,n):createBuffer(e,t).fill(r):createBuffer(e,t)}(null,e,t,r)},Buffer.allocUnsafe=function(e){return allocUnsafe(null,e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(null,e)},Buffer.isBuffer=function isBuffer(e){return!(null==e||!e._isBuffer)},Buffer.compare=function compare(e,t){if(!Buffer.isBuffer(e)||!Buffer.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,s=Math.min(r,n);o<s;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},Buffer.isEncoding=function isEncoding(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function concat(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=Buffer.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var i=e[r];if(!Buffer.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function swap16(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)swap(this,t,t+1);return this},Buffer.prototype.swap32=function swap32(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)swap(this,t,t+3),swap(this,t+1,t+2);return this},Buffer.prototype.swap64=function swap64(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)swap(this,t,t+7),swap(this,t+1,t+6),swap(this,t+2,t+5),swap(this,t+3,t+4);return this},Buffer.prototype.toString=function toString(){var e=0|this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer.prototype.equals=function equals(e){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer.compare(this,e)},Buffer.prototype.inspect=function inspect(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},Buffer.prototype.compare=function compare(e,t,r,n,o){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(this===e)return 0;for(var s=(o>>>=0)-(n>>>=0),i=(r>>>=0)-(t>>>=0),a=Math.min(s,i),u=this.slice(n,o),c=e.slice(t,r),f=0;f<a;++f)if(u[f]!==c[f]){s=u[f],i=c[f];break}return s<i?-1:i<s?1:0},Buffer.prototype.includes=function includes(e,t,r){return-1!==this.indexOf(e,t,r)},Buffer.prototype.indexOf=function indexOf(e,t,r){return bidirectionalIndexOf(this,e,t,r,!0)},Buffer.prototype.lastIndexOf=function lastIndexOf(e,t,r){return bidirectionalIndexOf(this,e,t,r,!1)},Buffer.prototype.write=function write(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return hexWrite(this,e,t,r);case"utf8":case"utf-8":return utf8Write(this,e,t,r);case"ascii":return asciiWrite(this,e,t,r);case"latin1":case"binary":return latin1Write(this,e,t,r);case"base64":return base64Write(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var i=4096;function asciiSlice(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function latin1Slice(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function hexSlice(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",s=t;s<r;++s)o+=toHex(e[s]);return o}function utf16leSlice(e,t,r){for(var n=e.slice(t,r),o="",s=0;s<n.length;s+=2)o+=String.fromCharCode(n[s]+256*n[s+1]);return o}function checkOffset(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,r,n,o,s){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function objectWriteUInt16(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,s=Math.min(e.length-r,2);o<s;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function objectWriteUInt32(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,s=Math.min(e.length-r,4);o<s;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function checkIEEE754(e,t,r,n,o,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(e,t,r,n,s){return s||checkIEEE754(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function writeDouble(e,t,r,n,s){return s||checkIEEE754(e,0,r,8),o.write(e,t,r,n,52,8),r+8}Buffer.prototype.slice=function slice(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),Buffer.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=Buffer.prototype;else{var o=t-e;r=new Buffer(o,void 0);for(var s=0;s<o;++s)r[s]=this[s+e]}return r},Buffer.prototype.readUIntLE=function readUIntLE(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e],o=1,s=0;++s<t&&(o*=256);)n+=this[e+s]*o;return n},Buffer.prototype.readUIntBE=function readUIntBE(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},Buffer.prototype.readUInt8=function readUInt8(e,t){return t||checkOffset(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function readUInt16LE(e,t){return t||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function readUInt16BE(e,t){return t||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function readUInt32LE(e,t){return t||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function readUInt32BE(e,t){return t||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function readIntLE(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e],o=1,s=0;++s<t&&(o*=256);)n+=this[e+s]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},Buffer.prototype.readIntBE=function readIntBE(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=t,o=1,s=this[e+--n];n>0&&(o*=256);)s+=this[e+--n]*o;return s>=(o*=128)&&(s-=Math.pow(2,8*t)),s},Buffer.prototype.readInt8=function readInt8(e,t){return t||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer.prototype.readInt16LE=function readInt16LE(e,t){t||checkOffset(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function readInt16BE(e,t){t||checkOffset(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function readInt32LE(e,t){return t||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function readInt32BE(e,t){return t||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function readFloatLE(e,t){return t||checkOffset(e,4,this.length),o.read(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function readFloatBE(e,t){return t||checkOffset(e,4,this.length),o.read(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function readDoubleLE(e,t){return t||checkOffset(e,8,this.length),o.read(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function readDoubleBE(e,t){return t||checkOffset(e,8,this.length),o.read(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function writeUIntLE(e,t,r,n){(e=+e,t|=0,r|=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,s=0;for(this[t]=255&e;++s<r&&(o*=256);)this[t+s]=e/o&255;return t+r},Buffer.prototype.writeUIntBE=function writeUIntBE(e,t,r,n){(e=+e,t|=0,r|=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,s=1;for(this[t+o]=255&e;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+r},Buffer.prototype.writeUInt8=function writeUInt8(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Buffer.prototype.writeUInt16LE=function writeUInt16LE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer.prototype.writeUInt16BE=function writeUInt16BE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer.prototype.writeUInt32LE=function writeUInt32LE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):objectWriteUInt32(this,e,t,!0),t+4},Buffer.prototype.writeUInt32BE=function writeUInt32BE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer.prototype.writeIntLE=function writeIntLE(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);checkInt(this,e,t,r,o-1,-o)}var s=0,i=1,a=0;for(this[t]=255&e;++s<r&&(i*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/i>>0)-a&255;return t+r},Buffer.prototype.writeIntBE=function writeIntBE(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);checkInt(this,e,t,r,o-1,-o)}var s=r-1,i=1,a=0;for(this[t+s]=255&e;--s>=0&&(i*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/i>>0)-a&255;return t+r},Buffer.prototype.writeInt8=function writeInt8(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer.prototype.writeInt16LE=function writeInt16LE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer.prototype.writeInt16BE=function writeInt16BE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer.prototype.writeInt32LE=function writeInt32LE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):objectWriteUInt32(this,e,t,!0),t+4},Buffer.prototype.writeInt32BE=function writeInt32BE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer.prototype.writeFloatLE=function writeFloatLE(e,t,r){return writeFloat(this,e,t,!0,r)},Buffer.prototype.writeFloatBE=function writeFloatBE(e,t,r){return writeFloat(this,e,t,!1,r)},Buffer.prototype.writeDoubleLE=function writeDoubleLE(e,t,r){return writeDouble(this,e,t,!0,r)},Buffer.prototype.writeDoubleBE=function writeDoubleBE(e,t,r){return writeDouble(this,e,t,!1,r)},Buffer.prototype.copy=function copy(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,s=n-r;if(this===e&&r<t&&t<n)for(o=s-1;o>=0;--o)e[o+t]=this[o+r];else if(s<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+s),t);return s},Buffer.prototype.fill=function fill(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var s;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var i=Buffer.isBuffer(e)?e:utf8ToBytes(new Buffer(e,n).toString()),a=i.length;for(s=0;s<r-t;++s)this[s+t]=i[s%a]}return this};var a=/[^+\/0-9A-Za-z-_]/g;function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,t){var r;t=t||1/0;for(var n=e.length,o=null,s=[],i=0;i<n;++i){if((r=e.charCodeAt(i))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(i+1===n){(t-=3)>-1&&s.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&s.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function base64ToBytes(e){return n.toByteArray(function base64clean(e){if((e=function stringtrim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(a,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function blitBuffer(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/process/browser.js":function(e,t){var r,n,o=e.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(r===setTimeout)return setTimeout(e,0);if((r===defaultSetTimout||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){r=defaultSetTimout}try{n="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){n=defaultClearTimeout}}();var s,i=[],a=!1,u=-1;function cleanUpNextTick(){a&&s&&(a=!1,s.length?i=s.concat(i):u=-1,i.length&&drainQueue())}function drainQueue(){if(!a){var e=runTimeout(cleanUpNextTick);a=!0;for(var t=i.length;t;){for(s=i,i=[];++u<t;)s&&s[u].run();u=-1,t=i.length}s=null,a=!1,function runClearTimeout(e){if(n===clearTimeout)return clearTimeout(e);if((n===defaultClearTimeout||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];i.push(new Item(e,t)),1!==i.length||a||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=noop,o.addListener=noop,o.once=noop,o.off=noop,o.removeListener=noop,o.removeAllListeners=noop,o.emit=noop,o.prependListener=noop,o.prependOnceListener=noop,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/reflect-metadata/Reflect.js":function(e,t,r){(function(e,t){var r;!function(r){!function(n){var o="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),s=makeExporter(r);function makeExporter(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0===o.Reflect?o.Reflect=r:s=makeExporter(o.Reflect,s),function(t){var r=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,o=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",i="function"==typeof Object.create,a={__proto__:[]}instanceof Array,u=!i&&!a,c={create:i?function(){return MakeDictionary(Object.create(null))}:a?function(){return MakeDictionary({__proto__:null})}:function(){return MakeDictionary({})},has:u?function(e,t){return r.call(e,t)}:function(e,t){return t in e},get:u?function(e,t){return r.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},f=Object.getPrototypeOf(Function),l="object"==typeof e&&e.env&&"true"===e.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?CreateMapPolyfill():Map,p=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?CreateSetPolyfill():Set,h=new(l||"function"!=typeof WeakMap?CreateWeakMapPolyfill():WeakMap);function decorate(e,t,r,n){if(IsUndefined(r)){if(!IsArray(e))throw new TypeError;if(!IsConstructor(t))throw new TypeError;return DecorateConstructor(e,t)}if(!IsArray(e))throw new TypeError;if(!IsObject(t))throw new TypeError;if(!IsObject(n)&&!IsUndefined(n)&&!IsNull(n))throw new TypeError;return IsNull(n)&&(n=void 0),DecorateProperty(e,t,r=ToPropertyKey(r),n)}function metadata(e,t){function decorator(r,n){if(!IsObject(r))throw new TypeError;if(!IsUndefined(n)&&!IsPropertyKey(n))throw new TypeError;OrdinaryDefineOwnMetadata(e,t,r,n)}return decorator}function defineMetadata(e,t,r,n){if(!IsObject(r))throw new TypeError;return IsUndefined(n)||(n=ToPropertyKey(n)),OrdinaryDefineOwnMetadata(e,t,r,n)}function hasMetadata(e,t,r){if(!IsObject(t))throw new TypeError;return IsUndefined(r)||(r=ToPropertyKey(r)),OrdinaryHasMetadata(e,t,r)}function hasOwnMetadata(e,t,r){if(!IsObject(t))throw new TypeError;return IsUndefined(r)||(r=ToPropertyKey(r)),OrdinaryHasOwnMetadata(e,t,r)}function getMetadata(e,t,r){if(!IsObject(t))throw new TypeError;return IsUndefined(r)||(r=ToPropertyKey(r)),OrdinaryGetMetadata(e,t,r)}function getOwnMetadata(e,t,r){if(!IsObject(t))throw new TypeError;return IsUndefined(r)||(r=ToPropertyKey(r)),OrdinaryGetOwnMetadata(e,t,r)}function getMetadataKeys(e,t){if(!IsObject(e))throw new TypeError;return IsUndefined(t)||(t=ToPropertyKey(t)),OrdinaryMetadataKeys(e,t)}function getOwnMetadataKeys(e,t){if(!IsObject(e))throw new TypeError;return IsUndefined(t)||(t=ToPropertyKey(t)),OrdinaryOwnMetadataKeys(e,t)}function deleteMetadata(e,t,r){if(!IsObject(t))throw new TypeError;IsUndefined(r)||(r=ToPropertyKey(r));var n=GetOrCreateMetadataMap(t,r,!1);if(IsUndefined(n))return!1;if(!n.delete(e))return!1;if(n.size>0)return!0;var o=h.get(t);return o.delete(r),o.size>0||h.delete(t),!0}function DecorateConstructor(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!IsUndefined(n)&&!IsNull(n)){if(!IsConstructor(n))throw new TypeError;t=n}}return t}function DecorateProperty(e,t,r,n){for(var o=e.length-1;o>=0;--o){var s=(0,e[o])(t,r,n);if(!IsUndefined(s)&&!IsNull(s)){if(!IsObject(s))throw new TypeError;n=s}}return n}function GetOrCreateMetadataMap(e,t,r){var n=h.get(e);if(IsUndefined(n)){if(!r)return;n=new d,h.set(e,n)}var o=n.get(t);if(IsUndefined(o)){if(!r)return;o=new d,n.set(t,o)}return o}function OrdinaryHasMetadata(e,t,r){if(OrdinaryHasOwnMetadata(e,t,r))return!0;var n=OrdinaryGetPrototypeOf(t);return!IsNull(n)&&OrdinaryHasMetadata(e,n,r)}function OrdinaryHasOwnMetadata(e,t,r){var n=GetOrCreateMetadataMap(t,r,!1);return!IsUndefined(n)&&ToBoolean(n.has(e))}function OrdinaryGetMetadata(e,t,r){if(OrdinaryHasOwnMetadata(e,t,r))return OrdinaryGetOwnMetadata(e,t,r);var n=OrdinaryGetPrototypeOf(t);return IsNull(n)?void 0:OrdinaryGetMetadata(e,n,r)}function OrdinaryGetOwnMetadata(e,t,r){var n=GetOrCreateMetadataMap(t,r,!1);if(!IsUndefined(n))return n.get(e)}function OrdinaryDefineOwnMetadata(e,t,r,n){GetOrCreateMetadataMap(r,n,!0).set(e,t)}function OrdinaryMetadataKeys(e,t){var r=OrdinaryOwnMetadataKeys(e,t),n=OrdinaryGetPrototypeOf(e);if(null===n)return r;var o=OrdinaryMetadataKeys(n,t);if(o.length<=0)return r;if(r.length<=0)return o;for(var s=new p,i=[],a=0,u=r;a<u.length;a++){var c=u[a];s.has(c)||(s.add(c),i.push(c))}for(var f=0,l=o;f<l.length;f++){c=l[f];s.has(c)||(s.add(c),i.push(c))}return i}function OrdinaryOwnMetadataKeys(e,t){var r=[],n=GetOrCreateMetadataMap(e,t,!1);if(IsUndefined(n))return r;for(var o=GetIterator(n.keys()),s=0;;){var i=IteratorStep(o);if(!i)return r.length=s,r;var a=IteratorValue(i);try{r[s]=a}catch(e){try{IteratorClose(o)}finally{throw e}}s++}}function Type(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function IsUndefined(e){return void 0===e}function IsNull(e){return null===e}function IsSymbol(e){return"symbol"==typeof e}function IsObject(e){return"object"==typeof e?null!==e:"function"==typeof e}function ToPrimitive(e,t){switch(Type(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",n=GetMethod(e,o);if(void 0!==n){var s=n.call(e,r);if(IsObject(s))throw new TypeError;return s}return OrdinaryToPrimitive(e,"default"===r?"number":r)}function OrdinaryToPrimitive(e,t){if("string"===t){var r=e.toString;if(IsCallable(r))if(!IsObject(o=r.call(e)))return o;if(IsCallable(n=e.valueOf))if(!IsObject(o=n.call(e)))return o}else{var n;if(IsCallable(n=e.valueOf))if(!IsObject(o=n.call(e)))return o;var o,s=e.toString;if(IsCallable(s))if(!IsObject(o=s.call(e)))return o}throw new TypeError}function ToBoolean(e){return!!e}function ToString(e){return""+e}function ToPropertyKey(e){var t=ToPrimitive(e,3);return IsSymbol(t)?t:ToString(t)}function IsArray(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function IsCallable(e){return"function"==typeof e}function IsConstructor(e){return"function"==typeof e}function IsPropertyKey(e){switch(Type(e)){case 3:case 4:return!0;default:return!1}}function GetMethod(e,t){var r=e[t];if(null!=r){if(!IsCallable(r))throw new TypeError;return r}}function GetIterator(e){var t=GetMethod(e,s);if(!IsCallable(t))throw new TypeError;var r=t.call(e);if(!IsObject(r))throw new TypeError;return r}function IteratorValue(e){return e.value}function IteratorStep(e){var t=e.next();return!t.done&&t}function IteratorClose(e){var t=e.return;t&&t.call(e)}function OrdinaryGetPrototypeOf(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===f)return t;if(t!==f)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var o=n.constructor;return"function"!=typeof o||o===e?t:o}function CreateMapPolyfill(){var e={},t=[],r=function(){function MapIterator(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return MapIterator.prototype["@@iterator"]=function(){return this},MapIterator.prototype[s]=function(){return this},MapIterator.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},MapIterator.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},MapIterator.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},MapIterator}();return function(){function Map(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(Map.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Map.prototype.has=function(e){return this._find(e,!1)>=0},Map.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},Map.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},Map.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,o=r+1;o<n;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},Map.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},Map.prototype.keys=function(){return new r(this._keys,this._values,getKey)},Map.prototype.values=function(){return new r(this._keys,this._values,getValue)},Map.prototype.entries=function(){return new r(this._keys,this._values,getEntry)},Map.prototype["@@iterator"]=function(){return this.entries()},Map.prototype[s]=function(){return this.entries()},Map.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},Map}();function getKey(e,t){return e}function getValue(e,t){return t}function getEntry(e,t){return[e,t]}}function CreateSetPolyfill(){return function(){function Set(){this._map=new d}return Object.defineProperty(Set.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Set.prototype.has=function(e){return this._map.has(e)},Set.prototype.add=function(e){return this._map.set(e,e),this},Set.prototype.delete=function(e){return this._map.delete(e)},Set.prototype.clear=function(){this._map.clear()},Set.prototype.keys=function(){return this._map.keys()},Set.prototype.values=function(){return this._map.values()},Set.prototype.entries=function(){return this._map.entries()},Set.prototype["@@iterator"]=function(){return this.keys()},Set.prototype[s]=function(){return this.keys()},Set}()}function CreateWeakMapPolyfill(){var e=16,t=c.create(),n=CreateUniqueKey();return function(){function WeakMap(){this._key=CreateUniqueKey()}return WeakMap.prototype.has=function(e){var t=GetOrCreateWeakMapTable(e,!1);return void 0!==t&&c.has(t,this._key)},WeakMap.prototype.get=function(e){var t=GetOrCreateWeakMapTable(e,!1);return void 0!==t?c.get(t,this._key):void 0},WeakMap.prototype.set=function(e,t){return GetOrCreateWeakMapTable(e,!0)[this._key]=t,this},WeakMap.prototype.delete=function(e){var t=GetOrCreateWeakMapTable(e,!1);return void 0!==t&&delete t[this._key]},WeakMap.prototype.clear=function(){this._key=CreateUniqueKey()},WeakMap}();function CreateUniqueKey(){var e;do{e="@@WeakMap@@"+CreateUUID()}while(c.has(t,e));return t[e]=!0,e}function GetOrCreateWeakMapTable(e,t){if(!r.call(e,n)){if(!t)return;Object.defineProperty(e,n,{value:c.create()})}return e[n]}function FillRandomBytes(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function GenRandomBytes(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):FillRandomBytes(new Uint8Array(e),e):FillRandomBytes(new Array(e),e)}function CreateUUID(){var t=GenRandomBytes(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var o=t[n];4!==n&&6!==n&&8!==n||(r+="-"),o<16&&(r+="0"),r+=o.toString(16).toLowerCase()}return r}}function MakeDictionary(e){return e.__=void 0,delete e.__,e}t("decorate",decorate),t("metadata",metadata),t("defineMetadata",defineMetadata),t("hasMetadata",hasMetadata),t("hasOwnMetadata",hasOwnMetadata),t("getMetadata",getMetadata),t("getOwnMetadata",getOwnMetadata),t("getMetadataKeys",getMetadataKeys),t("getOwnMetadataKeys",getOwnMetadataKeys),t("deleteMetadata",deleteMetadata)}(s)}()}(r||(r={}))}).call(this,r("./node_modules/process/browser.js"),r("./node_modules/webpack/buildin/global.js"))},"./node_modules/webpack/buildin/global.js":function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},"./node_modules/ws/browser.js":function(e,t,r){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},"./src/client/ButtplugBrowserWebsocketClientConnector.ts":function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n.throw(e))}catch(e){s(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtplugBrowserWebsocketClientConnector=void 0;const o=r("./src/core/MessageUtils.ts"),s=r("./src/utils/ButtplugMessageSorter.ts"),i=r("./src/utils/ButtplugBrowserWebsocketConnector.ts");class ButtplugBrowserWebsocketClientConnector extends i.ButtplugBrowserWebsocketConnector{constructor(){super(...arguments),this._sorter=new s.ButtplugMessageSorter(!0),this.Send=e=>n(this,void 0,void 0,(function*(){if(!this.Connected)throw new Error("ButtplugClient not connected");const t=this._sorter.PrepareOutgoingMessage(e);return this.SendMessage(e),yield t})),this.ParseIncomingMessage=e=>{if("string"==typeof e.data){const t=(0,o.FromJSON)(e.data),r=this._sorter.ParseIncomingMessages(t);this.emit("message",r)}else e.data,Blob}}OnReaderLoad(e){const t=(0,o.FromJSON)(e.target.result),r=this._sorter.ParseIncomingMessages(t);this.emit("message",r)}}t.ButtplugBrowserWebsocketClientConnector=ButtplugBrowserWebsocketClientConnector},"./src/client/ButtplugClientConnectorException.ts":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtplugClientConnectorException=void 0;const i=r("./src/core/Exceptions.ts"),a=s(r("./src/core/Messages.ts"));class ButtplugClientConnectorException extends i.ButtplugError{constructor(e){super(e,a.ErrorClass.ERROR_UNKNOWN)}}t.ButtplugClientConnectorException=ButtplugClientConnectorException},"./src/client/ButtplugClientDevice.ts":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n.throw(e))}catch(e){s(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtplugClientDevice=void 0;const a=s(r("./src/core/Messages.ts")),u=r("./src/core/Exceptions.ts"),c=r("./node_modules/eventemitter3/index.js");class ButtplugClientDevice extends c.EventEmitter{get name(){return this._deviceInfo.DeviceName}get displayName(){return this._deviceInfo.DeviceDisplayName}get index(){return this._deviceInfo.DeviceIndex}get messageTimingGap(){return this._deviceInfo.DeviceMessageTimingGap}get messageAttributes(){return this._deviceInfo.DeviceMessages}static fromMsg(e,t){return new ButtplugClientDevice(e,t)}constructor(e,t){super(),this._deviceInfo=e,this._sendClosure=t,this.allowedMsgs=new Map,e.DeviceMessages.update()}send(e){return i(this,void 0,void 0,(function*(){return yield this._sendClosure(this,e)}))}sendExpectOk(e){return i(this,void 0,void 0,(function*(){const t=yield this.send(e);switch(t.constructor){case a.Ok:return;case a.Error:throw u.ButtplugError.FromError(t);default:throw new u.ButtplugMessageError(`Message type ${t.constructor} not handled by SendMsgExpectOk`)}}))}scalar(e){return i(this,void 0,void 0,(function*(){Array.isArray(e)?yield this.sendExpectOk(new a.ScalarCmd(e,this.index)):yield this.sendExpectOk(new a.ScalarCmd([e],this.index))}))}scalarCommandBuilder(e,t){var r;return i(this,void 0,void 0,(function*(){const n=null===(r=this.messageAttributes.ScalarCmd)||void 0===r?void 0:r.filter((e=>e.ActuatorType===t));if(!n||0===n.length)throw new u.ButtplugDeviceError(`Device ${this.name} has no ${t} capabilities`);const o=[];if("number"==typeof e)n.forEach((r=>o.push(new a.ScalarSubcommand(r.Index,e,t))));else{if(!Array.isArray(e))throw new u.ButtplugDeviceError(`${t} can only take numbers or arrays of numbers.`);if(e.length>n.length)throw new u.ButtplugDeviceError(`${e.length} commands send to a device with ${n.length} vibrators`);n.forEach(((r,n)=>{o.push(new a.ScalarSubcommand(r.Index,e[n],t))}))}yield this.scalar(o)}))}get vibrateAttributes(){var e,t;return null!==(t=null===(e=this.messageAttributes.ScalarCmd)||void 0===e?void 0:e.filter((e=>e.ActuatorType===a.ActuatorType.Vibrate)))&&void 0!==t?t:[]}vibrate(e){return i(this,void 0,void 0,(function*(){yield this.scalarCommandBuilder(e,a.ActuatorType.Vibrate)}))}get oscillateAttributes(){var e,t;return null!==(t=null===(e=this.messageAttributes.ScalarCmd)||void 0===e?void 0:e.filter((e=>e.ActuatorType===a.ActuatorType.Oscillate)))&&void 0!==t?t:[]}oscillate(e){return i(this,void 0,void 0,(function*(){yield this.scalarCommandBuilder(e,a.ActuatorType.Oscillate)}))}get rotateAttributes(){var e;return null!==(e=this.messageAttributes.RotateCmd)&&void 0!==e?e:[]}rotate(e,t){return i(this,void 0,void 0,(function*(){const r=this.messageAttributes.RotateCmd;if(!r||0===r.length)throw new u.ButtplugDeviceError(`Device ${this.name} has no Rotate capabilities`);let n;if("number"==typeof e)n=a.RotateCmd.Create(this.index,new Array(r.length).fill([e,t]));else{if(!Array.isArray(e))throw new u.ButtplugDeviceError("SendRotateCmd can only take a number and boolean, or an array of number/boolean tuples");n=a.RotateCmd.Create(this.index,e)}yield this.sendExpectOk(n)}))}get linearAttributes(){var e;return null!==(e=this.messageAttributes.RotateCmd)&&void 0!==e?e:[]}linear(e,t){return i(this,void 0,void 0,(function*(){const r=this.messageAttributes.LinearCmd;if(!r||0===r.length)throw new u.ButtplugDeviceError(`Device ${this.name} has no Linear capabilities`);let n;if("number"==typeof e)n=a.LinearCmd.Create(this.index,new Array(r.length).fill([e,t]));else{if(!Array.isArray(e))throw new u.ButtplugDeviceError("SendLinearCmd can only take a number and number, or an array of number/number tuples");n=a.LinearCmd.Create(this.index,e)}yield this.sendExpectOk(n)}))}sensorRead(e,t){return i(this,void 0,void 0,(function*(){const r=yield this.send(new a.SensorReadCmd(this.index,e,t));switch(r.constructor){case a.SensorReading:return r.Data;case a.Error:throw u.ButtplugError.FromError(r);default:throw new u.ButtplugMessageError(`Message type ${r.constructor} not handled by sensorRead`)}}))}get hasBattery(){var e;const t=null===(e=this.messageAttributes.SensorReadCmd)||void 0===e?void 0:e.filter((e=>e.SensorType===a.SensorType.Battery));return void 0!==t&&t.length>0}battery(){var e;return i(this,void 0,void 0,(function*(){if(!this.hasBattery)throw new u.ButtplugDeviceError(`Device ${this.name} has no Battery capabilities`);const t=null===(e=this.messageAttributes.SensorReadCmd)||void 0===e?void 0:e.filter((e=>e.SensorType===a.SensorType.Battery));return(yield this.sensorRead(t[0].Index,a.SensorType.Battery))[0]/100}))}get hasRssi(){var e;const t=null===(e=this.messageAttributes.SensorReadCmd)||void 0===e?void 0:e.filter((e=>e.SensorType===a.SensorType.RSSI));return void 0!==t&&0===t.length}rssi(){var e;return i(this,void 0,void 0,(function*(){if(!this.hasRssi)throw new u.ButtplugDeviceError(`Device ${this.name} has no RSSI capabilities`);const t=null===(e=this.messageAttributes.SensorReadCmd)||void 0===e?void 0:e.filter((e=>e.SensorType===a.SensorType.RSSI));return(yield this.sensorRead(t[0].Index,a.SensorType.RSSI))[0]}))}rawRead(e,t,r){return i(this,void 0,void 0,(function*(){if(!this.messageAttributes.RawReadCmd)throw new u.ButtplugDeviceError(`Device ${this.name} has no raw read capabilities`);if(-1===this.messageAttributes.RawReadCmd.Endpoints.indexOf(e))throw new u.ButtplugDeviceError(`Device ${this.name} has no raw readable endpoint ${e}`);const n=yield this.send(new a.RawReadCmd(this.index,e,t,r));switch(n.constructor){case a.RawReading:return new Uint8Array(n.Data);case a.Error:throw u.ButtplugError.FromError(n);default:throw new u.ButtplugMessageError(`Message type ${n.constructor} not handled by rawRead`)}}))}rawWrite(e,t,r){return i(this,void 0,void 0,(function*(){if(!this.messageAttributes.RawWriteCmd)throw new u.ButtplugDeviceError(`Device ${this.name} has no raw write capabilities`);if(-1===this.messageAttributes.RawWriteCmd.Endpoints.indexOf(e))throw new u.ButtplugDeviceError(`Device ${this.name} has no raw writable endpoint ${e}`);yield this.sendExpectOk(new a.RawWriteCmd(this.index,e,t,r))}))}rawSubscribe(e){return i(this,void 0,void 0,(function*(){if(!this.messageAttributes.RawSubscribeCmd)throw new u.ButtplugDeviceError(`Device ${this.name} has no raw subscribe capabilities`);if(-1===this.messageAttributes.RawSubscribeCmd.Endpoints.indexOf(e))throw new u.ButtplugDeviceError(`Device ${this.name} has no raw subscribable endpoint ${e}`);yield this.sendExpectOk(new a.RawSubscribeCmd(this.index,e))}))}rawUnsubscribe(e){return i(this,void 0,void 0,(function*(){if(!this.messageAttributes.RawSubscribeCmd)throw new u.ButtplugDeviceError(`Device ${this.name} has no raw unsubscribe capabilities`);if(-1===this.messageAttributes.RawSubscribeCmd.Endpoints.indexOf(e))throw new u.ButtplugDeviceError(`Device ${this.name} has no raw unsubscribable endpoint ${e}`);yield this.sendExpectOk(new a.RawUnsubscribeCmd(this.index,e))}))}stop(){return i(this,void 0,void 0,(function*(){yield this.sendExpectOk(new a.StopDeviceCmd(this.index))}))}emitDisconnected(){this.emit("deviceremoved")}}t.ButtplugClientDevice=ButtplugClientDevice},"./src/client/ButtplugNodeWebsocketClientConnector.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ButtplugNodeWebsocketClientConnector=void 0;const n=r("./src/client/ButtplugBrowserWebsocketClientConnector.ts"),o=r("./node_modules/ws/browser.js");class ButtplugNodeWebsocketClientConnector extends n.ButtplugBrowserWebsocketClientConnector{constructor(){super(...arguments),this._websocketConstructor=o.WebSocket}}t.ButtplugNodeWebsocketClientConnector=ButtplugNodeWebsocketClientConnector},"./src/client/Client.ts":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n.throw(e))}catch(e){s(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtplugClient=void 0;const a=r("./src/core/Logging.ts"),u=r("./node_modules/eventemitter3/index.js"),c=r("./src/client/ButtplugClientDevice.ts"),f=s(r("./src/core/Messages.ts")),l=r("./src/core/Exceptions.ts"),d=r("./src/client/ButtplugClientConnectorException.ts");class ButtplugClient extends u.EventEmitter{constructor(e="Generic Buttplug Client"){super(),this._pingTimer=null,this._connector=null,this._devices=new Map,this._logger=a.ButtplugLogger.Logger,this._isScanning=!1,this.connect=e=>i(this,void 0,void 0,(function*(){this._logger.Info(`ButtplugClient: Connecting using ${e.constructor.name}`),yield e.Connect(),this._connector=e,this._connector.addListener("message",this.parseMessages),this._connector.addListener("disconnect",this.disconnectHandler),yield this.initializeConnection()})),this.disconnect=()=>i(this,void 0,void 0,(function*(){this._logger.Debug("ButtplugClient: Disconnect called"),this.checkConnector(),yield this.shutdownConnection(),yield this._connector.Disconnect()})),this.startScanning=()=>i(this,void 0,void 0,(function*(){this._logger.Debug("ButtplugClient: StartScanning called"),this._isScanning=!0,yield this.sendMsgExpectOk(new f.StartScanning)})),this.stopScanning=()=>i(this,void 0,void 0,(function*(){this._logger.Debug("ButtplugClient: StopScanning called"),this._isScanning=!1,yield this.sendMsgExpectOk(new f.StopScanning)})),this.stopAllDevices=()=>i(this,void 0,void 0,(function*(){this._logger.Debug("ButtplugClient: StopAllDevices"),yield this.sendMsgExpectOk(new f.StopAllDevices)})),this.disconnectHandler=()=>{this._logger.Info("ButtplugClient: Disconnect event receieved."),this.emit("disconnect")},this.parseMessages=e=>{for(const t of e)switch(t.constructor){case f.DeviceAdded:{const e=t,r=c.ButtplugClientDevice.fromMsg(e,this.sendDeviceMessageClosure);this._devices.set(e.DeviceIndex,r),this.emit("deviceadded",r);break}case f.DeviceRemoved:{const e=t;if(this._devices.has(e.DeviceIndex)){const t=this._devices.get(e.DeviceIndex);null==t||t.emitDisconnected(),this._devices.delete(e.DeviceIndex),this.emit("deviceremoved",t)}break}case f.ScanningFinished:this._isScanning=!1,this.emit("scanningfinished",t)}},this.initializeConnection=()=>i(this,void 0,void 0,(function*(){this.checkConnector();const e=yield this.sendMessage(new f.RequestServerInfo(this._clientName,f.MESSAGE_SPEC_VERSION));switch(e.constructor){case f.ServerInfo:{const t=e;this._logger.Info(`ButtplugClient: Connected to Server ${t.ServerName}`);t.MaxPingTime;if(t.MessageVersion<f.MESSAGE_SPEC_VERSION)throw yield this._connector.Disconnect(),l.ButtplugError.LogAndError(l.ButtplugInitError,this._logger,`Server protocol version ${t.MessageVersion} is older than client protocol version ${f.MESSAGE_SPEC_VERSION}. Please update server.`);return yield this.requestDeviceList(),!0}case f.Error:{yield this._connector.Disconnect();const t=e;throw l.ButtplugError.LogAndError(l.ButtplugInitError,this._logger,`Cannot connect to server. ${t.ErrorMessage}`)}}return!1})),this.requestDeviceList=()=>i(this,void 0,void 0,(function*(){this.checkConnector(),this._logger.Debug("ButtplugClient: ReceiveDeviceList called");(yield this.sendMessage(new f.RequestDeviceList)).Devices.forEach((e=>{if(this._devices.has(e.DeviceIndex))this._logger.Debug(`ButtplugClient: Device already added: ${e}`);else{const t=c.ButtplugClientDevice.fromMsg(e,this.sendDeviceMessageClosure);this._logger.Debug(`ButtplugClient: Adding Device: ${t}`),this._devices.set(e.DeviceIndex,t),this.emit("deviceadded",t)}}))})),this.shutdownConnection=()=>i(this,void 0,void 0,(function*(){yield this.stopAllDevices(),null!==this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=null)})),this.sendMsgExpectOk=e=>i(this,void 0,void 0,(function*(){const t=yield this.sendMessage(e);switch(t.constructor){case f.Ok:return;case f.Error:throw l.ButtplugError.FromError(t);default:throw l.ButtplugError.LogAndError(l.ButtplugMessageError,this._logger,`Message type ${t.constructor} not handled by SendMsgExpectOk`)}})),this.sendDeviceMessageClosure=(e,t)=>i(this,void 0,void 0,(function*(){return yield this.sendDeviceMessage(e,t)})),this._clientName=e,this._logger.Debug(`ButtplugClient: Client ${e} created.`)}get connected(){return null!==this._connector&&this._connector.Connected}get devices(){this.checkConnector();const e=[];return this._devices.forEach((t=>{e.push(t)})),e}get isScanning(){return this._isScanning}sendDeviceMessage(e,t){return i(this,void 0,void 0,(function*(){this.checkConnector();if(void 0===this._devices.get(e.index))throw l.ButtplugError.LogAndError(l.ButtplugDeviceError,this._logger,`Device ${e.index} not available.`);return t.DeviceIndex=e.index,yield this.sendMessage(t)}))}sendMessage(e){return i(this,void 0,void 0,(function*(){return this.checkConnector(),yield this._connector.Send(e)}))}checkConnector(){if(!this.connected)throw new d.ButtplugClientConnectorException("ButtplugClient not connected")}}t.ButtplugClient=ButtplugClient},"./src/client/IButtplugClientConnector.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"./src/core/Exceptions.ts":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtplugUnknownError=t.ButtplugPingError=t.ButtplugMessageError=t.ButtplugDeviceError=t.ButtplugInitError=t.ButtplugError=void 0;const i=s(r("./src/core/Messages.ts"));class ButtplugError extends Error{get ErrorClass(){return this.errorClass}get InnerError(){return this.innerError}get Id(){return this.messageId}get ErrorMessage(){return new i.Error(this.message,this.ErrorClass,this.Id)}static LogAndError(e,t,r,n=i.SYSTEM_MESSAGE_ID){return t.Error(r),new e(r,n)}static FromError(e){switch(e.ErrorCode){case i.ErrorClass.ERROR_DEVICE:return new ButtplugDeviceError(e.ErrorMessage,e.Id);case i.ErrorClass.ERROR_INIT:return new ButtplugInitError(e.ErrorMessage,e.Id);case i.ErrorClass.ERROR_UNKNOWN:return new ButtplugUnknownError(e.ErrorMessage,e.Id);case i.ErrorClass.ERROR_PING:return new ButtplugPingError(e.ErrorMessage,e.Id);case i.ErrorClass.ERROR_MSG:return new ButtplugMessageError(e.ErrorMessage,e.Id);default:throw new Error(`Message type ${e.ErrorCode} not handled`)}}constructor(e,t,r=i.SYSTEM_MESSAGE_ID,n){super(e),this.errorClass=i.ErrorClass.ERROR_UNKNOWN,this.errorClass=t,this.innerError=n,this.messageId=r}}t.ButtplugError=ButtplugError;class ButtplugInitError extends ButtplugError{constructor(e,t=i.SYSTEM_MESSAGE_ID){super(e,i.ErrorClass.ERROR_INIT,t)}}t.ButtplugInitError=ButtplugInitError;class ButtplugDeviceError extends ButtplugError{constructor(e,t=i.SYSTEM_MESSAGE_ID){super(e,i.ErrorClass.ERROR_DEVICE,t)}}t.ButtplugDeviceError=ButtplugDeviceError;class ButtplugMessageError extends ButtplugError{constructor(e,t=i.SYSTEM_MESSAGE_ID){super(e,i.ErrorClass.ERROR_MSG,t)}}t.ButtplugMessageError=ButtplugMessageError;class ButtplugPingError extends ButtplugError{constructor(e,t=i.SYSTEM_MESSAGE_ID){super(e,i.ErrorClass.ERROR_PING,t)}}t.ButtplugPingError=ButtplugPingError;class ButtplugUnknownError extends ButtplugError{constructor(e,t=i.SYSTEM_MESSAGE_ID){super(e,i.ErrorClass.ERROR_UNKNOWN,t)}}t.ButtplugUnknownError=ButtplugUnknownError},"./src/core/Logging.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ButtplugLogger=t.LogMessage=t.ButtplugLogLevel=void 0;const n=r("./node_modules/eventemitter3/index.js");var o;!function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Info=3]="Info",e[e.Debug=4]="Debug",e[e.Trace=5]="Trace"}(o=t.ButtplugLogLevel||(t.ButtplugLogLevel={}));class LogMessage{constructor(e,t){const r=new Date,n=r.getHours(),o=r.getMinutes(),s=r.getSeconds();this.timestamp=`${n}:${o}:${s}`,this.logMessage=e,this.logLevel=t}get Message(){return this.logMessage}get LogLevel(){return this.logLevel}get Timestamp(){return this.timestamp}get FormattedMessage(){return`${o[this.logLevel]} : ${this.timestamp} : ${this.logMessage}`}}t.LogMessage=LogMessage;class ButtplugLogger extends n.EventEmitter{static get Logger(){return void 0===ButtplugLogger.sLogger&&(ButtplugLogger.sLogger=new ButtplugLogger),this.sLogger}constructor(){super(),this.maximumConsoleLogLevel=o.Off,this.maximumEventLogLevel=o.Off}get MaximumConsoleLogLevel(){return this.maximumConsoleLogLevel}set MaximumConsoleLogLevel(e){this.maximumConsoleLogLevel=e}get MaximumEventLogLevel(){return this.maximumEventLogLevel}set MaximumEventLogLevel(e){this.maximumEventLogLevel=e}Error(e){this.AddLogMessage(e,o.Error)}Warn(e){this.AddLogMessage(e,o.Warn)}Info(e){this.AddLogMessage(e,o.Info)}Debug(e){this.AddLogMessage(e,o.Debug)}Trace(e){this.AddLogMessage(e,o.Trace)}AddLogMessage(e,t){if(t>this.maximumEventLogLevel&&t>this.maximumConsoleLogLevel)return;const r=new LogMessage(e,t);t<=this.maximumConsoleLogLevel&&console.log(r.FormattedMessage),t<=this.maximumEventLogLevel&&this.emit("log",r)}}t.ButtplugLogger=ButtplugLogger,ButtplugLogger.sLogger=void 0},"./src/core/MessageUtils.ts":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FromJSON=void 0;const i=r("./node_modules/class-transformer/esm5/index.js"),a=s(r("./src/core/Messages.ts"));function getMessageClass(e){for(const t of Object.values(a))if("function"==typeof t&&"Name"in t&&t.Name===e)return t;return null}t.FromJSON=function FromJSON(e){const t=JSON.parse(e),r=[];for(const e of Array.from(t)){const t=Object.getOwnPropertyNames(e)[0],n=getMessageClass(t);if(n){const o=(0,i.plainToInstance)(n,e[t]);o.update(),r.push(o)}}return r}},"./src/core/Messages.ts":function(e,t,r){"use strict";var n=this&&this.__decorate||function(e,t,r,n){var o,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.RawReading=t.RawUnsubscribeCmd=t.RawSubscribeCmd=t.RawWriteCmd=t.RawReadCmd=t.SensorReading=t.SensorReadCmd=t.LinearCmd=t.VectorSubcommand=t.RotateCmd=t.RotateSubcommand=t.ScalarCmd=t.ScalarSubcommand=t.GenericMessageSubcommand=t.StopAllDevices=t.StopDeviceCmd=t.ServerInfo=t.RequestServerInfo=t.ScanningFinished=t.StopScanning=t.StartScanning=t.RequestDeviceList=t.DeviceRemoved=t.DeviceAdded=t.DeviceList=t.DeviceInfo=t.Error=t.ErrorClass=t.Ping=t.Ok=t.ButtplugSystemMessage=t.ButtplugDeviceMessage=t.ButtplugMessage=t.SensorDeviceMessageAttributes=t.RawDeviceMessageAttributes=t.GenericDeviceMessageAttributes=t.SensorType=t.ActuatorType=t.MessageAttributes=t.MESSAGE_SPEC_VERSION=t.MAX_ID=t.DEFAULT_MESSAGE_ID=t.SYSTEM_MESSAGE_ID=void 0;const s=r("./node_modules/class-transformer/esm5/index.js");r("./node_modules/reflect-metadata/Reflect.js"),t.SYSTEM_MESSAGE_ID=0,t.DEFAULT_MESSAGE_ID=1,t.MAX_ID=4294967295,t.MESSAGE_SPEC_VERSION=3;class MessageAttributes{constructor(e){Object.assign(this,e)}update(){var e,t,r,n,o;null===(e=this.ScalarCmd)||void 0===e||e.forEach(((e,t)=>e.Index=t)),null===(t=this.RotateCmd)||void 0===t||t.forEach(((e,t)=>e.Index=t)),null===(r=this.LinearCmd)||void 0===r||r.forEach(((e,t)=>e.Index=t)),null===(n=this.SensorReadCmd)||void 0===n||n.forEach(((e,t)=>e.Index=t)),null===(o=this.SensorSubscribeCmd)||void 0===o||o.forEach(((e,t)=>e.Index=t))}}var i;t.MessageAttributes=MessageAttributes,function(e){e.Unknown="Unknown",e.Vibrate="Vibrate",e.Rotate="Rotate",e.Oscillate="Oscillate",e.Constrict="Constrict",e.Inflate="Inflate",e.Position="Position"}(t.ActuatorType||(t.ActuatorType={})),function(e){e.Unknown="Unknown",e.Battery="Battery",e.RSSI="RSSI",e.Button="Button",e.Pressure="Pressure"}(t.SensorType||(t.SensorType={}));t.GenericDeviceMessageAttributes=class GenericDeviceMessageAttributes{constructor(e){this.Index=0,Object.assign(this,e)}};t.RawDeviceMessageAttributes=class RawDeviceMessageAttributes{constructor(e){this.Endpoints=e}};t.SensorDeviceMessageAttributes=class SensorDeviceMessageAttributes{constructor(e){this.Index=0,Object.assign(this,e)}};class ButtplugMessage{constructor(e){this.Id=e}get Type(){return this.constructor}toJSON(){return JSON.stringify(this.toProtocolFormat())}toProtocolFormat(){const e={};return e[this.constructor.Name]=(0,s.instanceToPlain)(this),e}update(){}}t.ButtplugMessage=ButtplugMessage;class ButtplugDeviceMessage extends ButtplugMessage{constructor(e,t){super(t),this.DeviceIndex=e,this.Id=t}}t.ButtplugDeviceMessage=ButtplugDeviceMessage;class ButtplugSystemMessage extends ButtplugMessage{constructor(e=t.SYSTEM_MESSAGE_ID){super(e),this.Id=e}}t.ButtplugSystemMessage=ButtplugSystemMessage;class Ok extends ButtplugSystemMessage{constructor(e=t.DEFAULT_MESSAGE_ID){super(e),this.Id=e}}t.Ok=Ok,Ok.Name="Ok";class Ping extends ButtplugMessage{constructor(e=t.DEFAULT_MESSAGE_ID){super(e),this.Id=e}}t.Ping=Ping,Ping.Name="Ping",function(e){e[e.ERROR_UNKNOWN=0]="ERROR_UNKNOWN",e[e.ERROR_INIT=1]="ERROR_INIT",e[e.ERROR_PING=2]="ERROR_PING",e[e.ERROR_MSG=3]="ERROR_MSG",e[e.ERROR_DEVICE=4]="ERROR_DEVICE"}(i=t.ErrorClass||(t.ErrorClass={}));class Error extends ButtplugMessage{constructor(e,r=i.ERROR_UNKNOWN,n=t.DEFAULT_MESSAGE_ID){super(n),this.ErrorMessage=e,this.ErrorCode=r,this.Id=n}get Schemversion(){return 0}}t.Error=Error,Error.Name="Error";class DeviceInfo{constructor(e){Object.assign(this,e)}}n([(0,s.Type)((()=>MessageAttributes)),o("design:type",MessageAttributes)],DeviceInfo.prototype,"DeviceMessages",void 0),t.DeviceInfo=DeviceInfo;class DeviceList extends ButtplugMessage{constructor(e,r=t.DEFAULT_MESSAGE_ID){super(r),this.Devices=e,this.Id=r}update(){for(const e of this.Devices)e.DeviceMessages.update()}}DeviceList.Name="DeviceList",n([(0,s.Type)((()=>DeviceInfo)),o("design:type",Array)],DeviceList.prototype,"Devices",void 0),t.DeviceList=DeviceList;class DeviceAdded extends ButtplugSystemMessage{constructor(e){super(),Object.assign(this,e)}update(){this.DeviceMessages.update()}}DeviceAdded.Name="DeviceAdded",n([(0,s.Type)((()=>MessageAttributes)),o("design:type",MessageAttributes)],DeviceAdded.prototype,"DeviceMessages",void 0),t.DeviceAdded=DeviceAdded;class DeviceRemoved extends ButtplugSystemMessage{constructor(e){super(),this.DeviceIndex=e}}t.DeviceRemoved=DeviceRemoved,DeviceRemoved.Name="DeviceRemoved";class RequestDeviceList extends ButtplugMessage{constructor(e=t.DEFAULT_MESSAGE_ID){super(e),this.Id=e}}t.RequestDeviceList=RequestDeviceList,RequestDeviceList.Name="RequestDeviceList";class StartScanning extends ButtplugMessage{constructor(e=t.DEFAULT_MESSAGE_ID){super(e),this.Id=e}}t.StartScanning=StartScanning,StartScanning.Name="StartScanning";class StopScanning extends ButtplugMessage{constructor(e=t.DEFAULT_MESSAGE_ID){super(e),this.Id=e}}t.StopScanning=StopScanning,StopScanning.Name="StopScanning";class ScanningFinished extends ButtplugSystemMessage{constructor(){super()}}t.ScanningFinished=ScanningFinished,ScanningFinished.Name="ScanningFinished";class RequestServerInfo extends ButtplugMessage{constructor(e,r=0,n=t.DEFAULT_MESSAGE_ID){super(n),this.ClientName=e,this.MessageVersion=r,this.Id=n}}t.RequestServerInfo=RequestServerInfo,RequestServerInfo.Name="RequestServerInfo";class ServerInfo extends ButtplugSystemMessage{constructor(e,r,n,o=t.DEFAULT_MESSAGE_ID){super(),this.MessageVersion=e,this.MaxPingTime=r,this.ServerName=n,this.Id=o}}t.ServerInfo=ServerInfo,ServerInfo.Name="ServerInfo";class StopDeviceCmd extends ButtplugDeviceMessage{constructor(e=-1,r=t.DEFAULT_MESSAGE_ID){super(e,r),this.DeviceIndex=e,this.Id=r}}t.StopDeviceCmd=StopDeviceCmd,StopDeviceCmd.Name="StopDeviceCmd";class StopAllDevices extends ButtplugMessage{constructor(e=t.DEFAULT_MESSAGE_ID){super(e),this.Id=e}}t.StopAllDevices=StopAllDevices,StopAllDevices.Name="StopAllDevices";class GenericMessageSubcommand{constructor(e){this.Index=e}}t.GenericMessageSubcommand=GenericMessageSubcommand;t.ScalarSubcommand=class ScalarSubcommand extends GenericMessageSubcommand{constructor(e,t,r){super(e),this.Scalar=t,this.ActuatorType=r}};class ScalarCmd extends ButtplugDeviceMessage{constructor(e,r=-1,n=t.DEFAULT_MESSAGE_ID){super(r,n),this.Scalars=e,this.DeviceIndex=r,this.Id=n}}t.ScalarCmd=ScalarCmd,ScalarCmd.Name="ScalarCmd";class RotateSubcommand extends GenericMessageSubcommand{constructor(e,t,r){super(e),this.Speed=t,this.Clockwise=r}}t.RotateSubcommand=RotateSubcommand;class RotateCmd extends ButtplugDeviceMessage{static Create(e,t){const r=new Array;let n=0;for(const[e,o]of t)r.push(new RotateSubcommand(n,e,o)),++n;return new RotateCmd(r,e)}constructor(e,r=-1,n=t.DEFAULT_MESSAGE_ID){super(r,n),this.Rotations=e,this.DeviceIndex=r,this.Id=n}}t.RotateCmd=RotateCmd,RotateCmd.Name="RotateCmd";class VectorSubcommand extends GenericMessageSubcommand{constructor(e,t,r){super(e),this.Position=t,this.Duration=r}}t.VectorSubcommand=VectorSubcommand;class LinearCmd extends ButtplugDeviceMessage{static Create(e,t){const r=new Array;let n=0;for(const e of t)r.push(new VectorSubcommand(n,e[0],e[1])),++n;return new LinearCmd(r,e)}constructor(e,r=-1,n=t.DEFAULT_MESSAGE_ID){super(r,n),this.Vectors=e,this.DeviceIndex=r,this.Id=n}}t.LinearCmd=LinearCmd,LinearCmd.Name="LinearCmd";class SensorReadCmd extends ButtplugDeviceMessage{constructor(e,r,n,o=t.DEFAULT_MESSAGE_ID){super(e,o),this.DeviceIndex=e,this.SensorIndex=r,this.SensorType=n,this.Id=o}}t.SensorReadCmd=SensorReadCmd,SensorReadCmd.Name="SensorReadCmd";class SensorReading extends ButtplugDeviceMessage{constructor(e,r,n,o,s=t.DEFAULT_MESSAGE_ID){super(e,s),this.DeviceIndex=e,this.SensorIndex=r,this.SensorType=n,this.Data=o,this.Id=s}}t.SensorReading=SensorReading,SensorReading.Name="SensorReading";class RawReadCmd extends ButtplugDeviceMessage{constructor(e,r,n,o,s=t.DEFAULT_MESSAGE_ID){super(e,s),this.DeviceIndex=e,this.Endpoint=r,this.ExpectedLength=n,this.Timeout=o,this.Id=s}}t.RawReadCmd=RawReadCmd,RawReadCmd.Name="RawReadCmd";class RawWriteCmd extends ButtplugDeviceMessage{constructor(e,r,n,o,s=t.DEFAULT_MESSAGE_ID){super(e,s),this.DeviceIndex=e,this.Endpoint=r,this.Data=n,this.WriteWithResponse=o,this.Id=s}}t.RawWriteCmd=RawWriteCmd,RawWriteCmd.Name="RawWriteCmd";class RawSubscribeCmd extends ButtplugDeviceMessage{constructor(e,r,n=t.DEFAULT_MESSAGE_ID){super(e,n),this.DeviceIndex=e,this.Endpoint=r,this.Id=n}}t.RawSubscribeCmd=RawSubscribeCmd,RawSubscribeCmd.Name="RawSubscribeCmd";class RawUnsubscribeCmd extends ButtplugDeviceMessage{constructor(e,r,n=t.DEFAULT_MESSAGE_ID){super(e,n),this.DeviceIndex=e,this.Endpoint=r,this.Id=n}}t.RawUnsubscribeCmd=RawUnsubscribeCmd,RawUnsubscribeCmd.Name="RawUnsubscribeCmd";class RawReading extends ButtplugDeviceMessage{constructor(e,r,n,o=t.DEFAULT_MESSAGE_ID){super(e,o),this.DeviceIndex=e,this.Endpoint=r,this.Data=n,this.Id=o}}t.RawReading=RawReading,RawReading.Name="RawReading"},"./src/index.ts":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r("./src/client/Client.ts"),t),o(r("./src/client/ButtplugClientDevice.ts"),t),o(r("./src/client/ButtplugBrowserWebsocketClientConnector.ts"),t),o(r("./src/client/ButtplugNodeWebsocketClientConnector.ts"),t),o(r("./src/client/ButtplugClientConnectorException.ts"),t),o(r("./src/utils/ButtplugMessageSorter.ts"),t),o(r("./src/client/IButtplugClientConnector.ts"),t),o(r("./src/core/Messages.ts"),t),o(r("./src/core/MessageUtils.ts"),t),o(r("./src/core/Logging.ts"),t),o(r("./src/core/Exceptions.ts"),t)},"./src/utils/ButtplugBrowserWebsocketConnector.ts":function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n.throw(e))}catch(e){s(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtplugBrowserWebsocketConnector=void 0;const o=r("./node_modules/eventemitter3/index.js"),s=r("./src/core/MessageUtils.ts");class ButtplugBrowserWebsocketConnector extends o.EventEmitter{constructor(e){super(),this._url=e,this._websocketConstructor=null,this.Connect=()=>n(this,void 0,void 0,(function*(){var e;const t=new(null!==(e=this._websocketConstructor)&&void 0!==e?e:WebSocket)(this._url);let r,o;const s=new Promise(((e,t)=>{r=e,o=t})),conErrorCallback=()=>o();return t.addEventListener("open",(()=>n(this,void 0,void 0,(function*(){this._ws=t;try{yield this.Initialize(),this._ws.addEventListener("message",(e=>{this.ParseIncomingMessage(e)})),this._ws.removeEventListener("close",conErrorCallback),this._ws.addEventListener("close",this.Disconnect),r()}catch(e){console.log(e),o()}})))),t.addEventListener("close",conErrorCallback),s})),this.Disconnect=()=>n(this,void 0,void 0,(function*(){this.Connected&&(this._ws.close(),this._ws=void 0,this.emit("disconnect"))})),this.Initialize=()=>n(this,void 0,void 0,(function*(){return Promise.resolve()}))}get Connected(){return void 0!==this._ws}SendMessage(e){if(!this.Connected)throw new Error("ButtplugBrowserWebsocketConnector not connected");this._ws.send("["+e.toJSON()+"]")}ParseIncomingMessage(e){if("string"==typeof e.data){const t=(0,s.FromJSON)(e.data);this.emit("message",t)}else e.data,Blob}OnReaderLoad(e){const t=(0,s.FromJSON)(e.target.result);this.emit("message",t)}}t.ButtplugBrowserWebsocketConnector=ButtplugBrowserWebsocketConnector},"./src/utils/ButtplugMessageSorter.ts":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtplugMessageSorter=void 0;const i=s(r("./src/core/Messages.ts")),a=r("./src/core/Exceptions.ts");t.ButtplugMessageSorter=class ButtplugMessageSorter{constructor(e){this._useCounter=e,this._counter=1,this._waitingMsgs=new Map}PrepareOutgoingMessage(e){let t,r;this._useCounter&&(e.Id=this._counter,this._counter+=1);const n=new Promise(((e,n)=>{t=e,r=n}));return this._waitingMsgs.set(e.Id,[t,r]),n}ParseIncomingMessages(e){const t=[];for(const r of e)if(r.Id!==i.SYSTEM_MESSAGE_ID&&this._waitingMsgs.has(r.Id)){const[e,t]=this._waitingMsgs.get(r.Id);if(r.Type===i.Error){t(a.ButtplugError.FromError(r));continue}e(r)}else t.push(r);return t}}}})}));